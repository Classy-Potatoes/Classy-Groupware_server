DROP TABLE `TBL_APPROVAL`;
DROP TABLE `TBL_APPROVAL_LINE`;
DROP TABLE `TBL_CALENDAR`;
DROP TABLE `TBL_DEPT`;
DROP TABLE `TBL_EXPENSE`;
DROP TABLE `TBL_EXPENSE_DETAIL`;
DROP TABLE `TBL_FILE`;
DROP TABLE `TBL_HISTORY`;
DROP TABLE `TBL_JOB`;
DROP TABLE `TBL_LETTER`;
DROP TABLE `TBL_MEMBER`;
DROP TABLE `TBL_MEMBER_INFO`;
DROP TABLE `TBL_NOTE`;
DROP TABLE `TBL_NOTICE`;
DROP TABLE `TBL_PROJECT`;
DROP TABLE `TBL_PROJECT_MANAGER`;
DROP TABLE `TBL_PROJECT_PARTICIPANT`;
DROP TABLE `TBL_PROJECT_POST`;
DROP TABLE `TBL_PROJECT_REPLY`;
DROP TABLE `TBL_PROJECT_SCHEDULE`;
DROP TABLE `TBL_PROJECT_TASK`;
DROP TABLE `TBL_PROJECT_TODO`;
DROP TABLE `TBL_PROJECT_TODOLIST`;
DROP TABLE `TBL_REFERENCE`;
DROP TABLE `TBL_VACATION`;


CREATE TABLE `TBL_APPROVAL`
(
    `APPROVAL_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '문서고유코드',
    `APPROVAL_REGIST_DATE`    DATETIME NOT NULL COMMENT '상신일',
    `APPROVAL_STATUS`    VARCHAR(100) NOT NULL COMMENT '결재상태',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '상신인',
    `APPROVAL_TURNBACK_REASON`    VARCHAR(1000) COMMENT '반려사유',
    `APPROVAL_APPROVE_DATE`    DATETIME COMMENT '승인일',
    `APPROVAL_TURNBACK_DATE`    DATETIME COMMENT '반려일',
    `DOCUMENT_TYPE`    VARCHAR(100) NOT NULL COMMENT '서류양식구분',
    `DOCUMENT_TITLE`    VARCHAR(500) NOT NULL COMMENT '문서제목',
 PRIMARY KEY ( `APPROVAL_CODE` )
) COMMENT = '전자결재';


CREATE TABLE `TBL_APPROVAL_LINE`
(
    `APPROVAL_LINE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '결재선코드',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
    `TURN`    VARCHAR(100) NOT NULL COMMENT '결재순번',
    `APPROVAL_LINE_RESULT`    VARCHAR(100) COMMENT '결재결과',
    `APPROVAL_LINE_WAITING_STATUS`    VARCHAR(100) NOT NULL COMMENT '결재대기상태',
    `APPROVAL_LINE_DATE`    DATETIME COMMENT '결재일',
 PRIMARY KEY ( `APPROVAL_LINE_CODE` )
) COMMENT = '결재선';


CREATE TABLE `TBL_CALENDAR`
(
    `CALENDAR_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '일정번호',
    `CALENDAR_TITLE`    VARCHAR(100) NOT NULL COMMENT '제목',
    `CALENDAR_CONTENT`    VARCHAR(500) COMMENT '내용',
    `CALENDAR_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `CALENDAR_MODIFIED_DATE`    DATETIME NOT NULL COMMENT '수정일',
    `STATUS`    VARCHAR(100) NOT NULL COMMENT '상태',
    `CALENDAR_STARTED_DATE`    DATETIME NOT NULL COMMENT '시작일시',
    `CALENDAR_END_DATE`    DATETIME COMMENT '종료일시',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
 PRIMARY KEY ( `CALENDAR_CODE` )
) COMMENT = '개인일정';


CREATE TABLE `TBL_DEPT`
(
    `DEPT_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '부서코드',
    `DEPT_NAME`    VARCHAR(100) NOT NULL COMMENT '부서명',
    `DEPT_DESCRIBE`    VARCHAR(200) COMMENT '부서설명',
 PRIMARY KEY ( `DEPT_CODE` )
) COMMENT = '부서';


CREATE TABLE `TBL_EXPENSE`
(
    `EXPENSE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '지출결의서고유코드',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
    `EXPENSE_NOTE`    VARCHAR(1000) COMMENT '비고',
    `EXPENSE_STATUS`    VARCHAR(100) NOT NULL COMMENT '결제구분',
 PRIMARY KEY ( `EXPENSE_CODE` )
) COMMENT = '지출결의서';


CREATE TABLE `TBL_EXPENSE_DETAIL`
(
    `EXPENSE_DETAIL_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '상세코드',
    `EXPENSE_ACCOUNT`    VARCHAR(200) NOT NULL COMMENT '계정과목',
    `EXPENSE_DATE`    DATE NOT NULL COMMENT '지출일자',
    `EXPENSE_PRICE`    BIGINT NOT NULL COMMENT '금액',
    `EXPENSE_BRIEFS`    VARCHAR(400) COMMENT '적요',
    `EXPENSE_CODE`    BIGINT COMMENT '지출결의서고유코드',
 PRIMARY KEY ( `EXPENSE_DETAIL_CODE` )
) COMMENT = '지출결의상세';


CREATE TABLE `TBL_FILE`
(
    `FILE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '파일번호',
    `FILE_NAME`    VARCHAR(1000) NOT NULL COMMENT '파일명',
    `FILE_PATH_NAME`    VARCHAR(1000) NOT NULL COMMENT '경로명',
    `FILE_SAVE_NAME`    VARCHAR(1000) NOT NULL COMMENT '저장명',
    `FILE_EXT_NAME`    VARCHAR(200) NOT NULL COMMENT '확장자명',
    `FILE_TYPE`    VARCHAR(100) NOT NULL COMMENT '구분',
    `POST_CODE`    BIGINT COMMENT '프로젝트게시글코드',
    `TASK_CODE`    BIGINT COMMENT '프로젝트업무코드',
    `SCHEDULE_CODE`    BIGINT COMMENT '프로젝트일정코드',
    `NOTICE_CODE`    BIGINT COMMENT '공지 게시판 코드',
    `MEMBER_CODE`    BIGINT COMMENT '계정코드',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
 PRIMARY KEY ( `FILE_CODE` )
) COMMENT = '첨부파일';


CREATE TABLE `TBL_HISTORY`
(
    `HISTORY_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '히스토리 코드',
    `HISTORY_DATE`    DATETIME NOT NULL COMMENT '일자',
    `HISTORY_CATEGORY`    VARCHAR(100) NOT NULL COMMENT '변경항목',
    `DEPT_CODE`    BIGINT NOT NULL COMMENT '부서코드',
    `JOB_CODE`    BIGINT NOT NULL COMMENT '직급코드',
    `HISTORY_NOTE`    VARCHAR(200) NOT NULL COMMENT '비고',
    `INFO_CODE`    BIGINT COMMENT '사번',
 PRIMARY KEY ( `HISTORY_CODE` )
) COMMENT = '이력';


CREATE TABLE `TBL_JOB`
(
    `JOB_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '직급코드',
    `JOB_NAME`    VARCHAR(100) NOT NULL COMMENT '직급명',
 PRIMARY KEY ( `JOB_CODE` )
) COMMENT = '직급';


CREATE TABLE `TBL_LETTER`
(
    `LETTER_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '품의서고유코드',
    `LETTER_BODY`    VARCHAR(4000) NOT NULL COMMENT '문서내용',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
 PRIMARY KEY ( `LETTER_CODE` )
) COMMENT = '품의서';


CREATE TABLE `TBL_MEMBER`
(
    `MEMBER_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '계정코드',
    `MEMBER_ID`    VARCHAR(100) NOT NULL COMMENT '아이디',
    `MEMBER_PASSWORD`    VARCHAR(500) NOT NULL COMMENT '비밀번호',
    `MEMBER_STATUS`    VARCHAR(100) NOT NULL COMMENT '회원상태',
    `MEMBER_ROLE`    VARCHAR(100) NOT NULL COMMENT '권한',
    `MEMBER_JOIN_DATE`    DATETIME NOT NULL COMMENT '회원가입일',
    `MEMBER_UPDATE_DATE`    DATETIME NOT NULL COMMENT '상태변경일',
    `MEMBER_TOKEN`    VARCHAR(500) COMMENT '리프레쉬토큰',
    `INFO_CODE`    BIGINT NOT NULL COMMENT '사번',
 PRIMARY KEY ( `MEMBER_CODE` )
) COMMENT = '회원계정';


CREATE TABLE `TBL_MEMBER_INFO`
(
    `INFO_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '사번',
    `INFO_NAME`    VARCHAR(100) NOT NULL COMMENT '이름',
    `JOB_CODE`    BIGINT NOT NULL COMMENT '직급코드',
    `DEPT_CODE`    BIGINT NOT NULL COMMENT '부서코드',
    `INFO_EMAIL`    VARCHAR(200) NOT NULL COMMENT '이메일',
    `INFO_PHONE`    VARCHAR(100) COMMENT '휴대전화',
    `INFO_ZIPCODE`    BIGINT COMMENT '우편번호',
    `INFO_ADDRESS`    VARCHAR(300) COMMENT '주소',
    `INFO_ADDRESS_ADD`    VARCHAR(200) COMMENT '상세주소',
 PRIMARY KEY ( `INFO_CODE` )
) COMMENT = '회원정보';


# --------------------- 회원 정보 사번 시퀀스 관련 트리거 ------------------------
drop table tbl_infoCode_seq;

create table tbl_infoCode_seq (
    infoCode int not null auto_increment primary key
);



delimiter $$
create trigger tg_tbl_infoCode_insert
    BEFORE INSERT on tbl_member_info
    for each row
begin
    declare new_infoCode int;

    insert into tbl_infoCode_seq values (null);

    select last_insert_id() into new_infoCode;

    set new.INFO_CODE = concat( DATE_FORMAT(CURDATE(), '%Y%m'), LPAD(new_infoCode, 3, '0') );
end$$
delimiter ;

# --------------------- 회원 정보 사번 시퀀스 관련 트리거 ------------------------


CREATE TABLE `TBL_NOTE`
(
    `NOTE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '쪽지 코드',
    `NOTE_BODY`    VARCHAR(1000) NOT NULL COMMENT '쪽지 내용',
    `NOTE_SENT_DATE`    DATETIME NOT NULL COMMENT '보낸 날짜',
    `NOTE_SENDER_DELETE_DATE`    DATETIME COMMENT '발신인삭제일시',
    `NOTE_RECEIPT_STATUS`    VARCHAR(50) NOT NULL COMMENT '수신확인',
    `NOTE_SENDER_STATUS`    VARCHAR(100) NOT NULL COMMENT '발신인상태',
    `NOTE_SENDER`    BIGINT NOT NULL COMMENT '발신인',
    `NOTE_RECEIVER`    BIGINT NOT NULL COMMENT '수신인',
    `NOTE_RECEIVER_STATUS`    VARCHAR(100) NOT NULL COMMENT '수신인상태',
    `NOTE_RECEIVER_DELETE_DATE`    DATETIME COMMENT '수신인삭제일시',
 PRIMARY KEY ( `NOTE_CODE` )
) COMMENT = '쪽지';


CREATE TABLE `TBL_NOTICE`
(
    `NOTICE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '공지 게시판 코드',
    `NOTICE_TITLE`    VARCHAR(500) NOT NULL COMMENT '제목',
    `NOTICE_BODY`    VARCHAR(1000) NOT NULL COMMENT '내용',
    `NOTICE_REGISTER_DATE`    DATETIME COMMENT '작성 일자',
    `NOTICE_MODIFI_DATE`    DATETIME COMMENT '수정 일자',
    `NOTICE_DELETE_DATE`    DATETIME COMMENT '삭제 일자',
    `NOTICE_STATUS`    VARCHAR(50) NOT NULL COMMENT '게시여부',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
    `NOTICE_OPTION`    VARCHAR(50) NOT NULL COMMENT '구분',
 PRIMARY KEY ( `NOTICE_CODE` )
) COMMENT = '공지사항';


CREATE TABLE `TBL_PROJECT`
(
    `PROJECT_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트코드',
    `PROJECT_TITLE`    VARCHAR(100) NOT NULL COMMENT '프로젝트제목',
    `PROJECT_BODY`    VARCHAR(200) NOT NULL COMMENT '프로젝트내용',
    `PROJECT_START_DATE`    DATETIME NOT NULL COMMENT '시작날짜',
    `PROJECT_END_DATE`    DATETIME NOT NULL COMMENT '마감날짜',
    `PROJECT_STATUS`    VARCHAR(50) NOT NULL COMMENT '프로젝트상태',
    `DEPT_CODE`    BIGINT NOT NULL COMMENT '부서코드',
    `PROJECT_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `PROJECT_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '작성자',
 PRIMARY KEY ( `PROJECT_CODE` )
) COMMENT = '프로젝트';


CREATE TABLE `TBL_PROJECT_MANAGER`
(
    `PROJECT_MANAGER_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '업무담당자코드',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '담당자',
    `PROJECT_OPTION`    VARCHAR(100) COMMENT '구분',
    `TASK_CODE`    BIGINT COMMENT '프로젝트업무코드',
    `SCHEDULE_CODE`    BIGINT COMMENT '프로젝트일정코드',
    `TODO_LIST_CODE`    BIGINT COMMENT '할일리스트코드',
 PRIMARY KEY ( `PROJECT_MANAGER_CODE` )
) COMMENT = '프로젝트담당자';


CREATE TABLE `TBL_PROJECT_PARTICIPANT`
(
    `PROJECT_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트코드',
    `INFO_CODE`    BIGINT NOT NULL COMMENT '사번',
 PRIMARY KEY ( `PROJECT_CODE`,`INFO_CODE` )
) COMMENT = '프로젝트참석자';


CREATE TABLE `TBL_PROJECT_POST`
(
    `POST_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트게시글코드',
    `POST_TITLE`    VARCHAR(300) NOT NULL COMMENT '게시글제목',
    `POST_BODY`    VARCHAR(1000) NOT NULL COMMENT '게시글내용',
    `POST_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `POST_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `POST_STATUS`    VARCHAR(50) NOT NULL COMMENT '게시여부',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '작성자',
    `PROJECT_CODE`    BIGINT NOT NULL COMMENT '프로젝트코드',
 PRIMARY KEY ( `POST_CODE` )
) COMMENT = '프로젝트게시글';


CREATE TABLE `TBL_PROJECT_REPLY`
(
    `REPLY_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트댓글코드',
    `REPLY_BODY`    VARCHAR(500) NOT NULL COMMENT '댓글내용',
    `REPLY_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `REPLY_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `REPLY_STATE`    VARCHAR(10) NOT NULL COMMENT '게시여부',
    `REPLY_OPTION`    VARCHAR(50) NOT NULL COMMENT '구분',
    `POST_CODE`    BIGINT COMMENT '프로젝트게시글코드',
    `SCHEDULE_CODE`    BIGINT COMMENT '프로젝트일정코드',
    `TODO_LIST_CODE`    BIGINT COMMENT '할일리스트코드',
    `TASK_CODE`    BIGINT COMMENT '프로젝트업무코드',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
 PRIMARY KEY ( `REPLY_CODE` )
) COMMENT = '프로젝트댓글';


CREATE TABLE `TBL_PROJECT_SCHEDULE`
(
    `SCHEDULE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트일정코드',
    `SCHEDULE_TITLE`    VARCHAR(100) NOT NULL COMMENT '일정제목',
    `SCHEDULE_BODY`    VARCHAR(500) COMMENT '일정내용',
    `SCHEDULE_START_DATE`    DATETIME NOT NULL COMMENT '시작일',
    `SCHEDULE_END_DATE`    DATETIME COMMENT '종료일',
    `SCHEDULE_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `SCHEDULE_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
    `PROJECT_CODE`    BIGINT NOT NULL COMMENT '프로젝트코드',
    `SCHEDULE_STATUS`    VARCHAR(100) NOT NULL COMMENT '상태',
 PRIMARY KEY ( `SCHEDULE_CODE` )
) COMMENT = '프로젝트일정';


CREATE TABLE `TBL_PROJECT_TASK`
(
    `TASK_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '프로젝트업무코드',
    `TASK_TITLE`    VARCHAR(300) NOT NULL COMMENT '업무명',
    `TASK_BODY`    VARCHAR(500) NOT NULL COMMENT '업무내용',
    `TASK_STATUS`    VARCHAR(50) NOT NULL COMMENT '업무상태',
    `TASK_START_DATE`    DATETIME NOT NULL COMMENT '시작일시',
    `TASK_END_DATE`    DATETIME NOT NULL COMMENT '마감일시',
    `TASK_PRIORITY`    VARCHAR(30) NOT NULL COMMENT '우선순위',
    `TASK_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `TASK_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '작성자',
    `TASK_REQUEST_DATE`    DATETIME COMMENT '요청일자',
    `TASK_PROGRESS_DATE`    DATETIME COMMENT '진행일자',
    `TASK_COMPLETE_DATE`    DATETIME COMMENT '완료일자',
    `TASK_DEFER_DATE`    DATETIME COMMENT '보류일자',
    `TASK_DELETE_STATUS`    VARCHAR(30) NOT NULL COMMENT '삭제여부',
    `PROJECT_CODE`    BIGINT NOT NULL COMMENT '프로젝트코드',
 PRIMARY KEY ( `TASK_CODE` )
) COMMENT = '프로젝트업무';


CREATE TABLE `TBL_PROJECT_TODO`
(
    `TODO_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '할일코드',
    `TODO_TITLE`    VARCHAR(300) NOT NULL COMMENT '할일제목',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '작성자',
    `PROJECT_CODE`    BIGINT NOT NULL COMMENT '프로젝트코드',
    `TODO_CREATED_DATE`    DATETIME NOT NULL COMMENT '작성일',
    `TODO_MODIFY_DATE`    DATETIME COMMENT '수정일',
    `TODO_STATUS`    VARCHAR(100) NOT NULL COMMENT '상태',
 PRIMARY KEY ( `TODO_CODE` )
) COMMENT = '프로젝트할일';


CREATE TABLE `TBL_PROJECT_TODOLIST`
(
    `TODO_LIST_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '할일리스트코드',
    `TODO_CODE`    BIGINT NOT NULL COMMENT '할일코드',
    `TODO_BODY`    VARCHAR(500) NOT NULL COMMENT '할일내용',
    `TODO_END_DATE`    DATETIME NOT NULL COMMENT '마감일',
    `TOFO_STATUS`    VARCHAR(50) NOT NULL COMMENT '완료여부',
 PRIMARY KEY ( `TODO_LIST_CODE` )
) COMMENT = '프로젝트할일리스트';


CREATE TABLE `TBL_REFERENCE`
(
    `REFERENCE_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '참조자고유번호',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
    `MEMBER_CODE`    BIGINT NOT NULL COMMENT '계정코드',
 PRIMARY KEY ( `REFERENCE_CODE` )
) COMMENT = '참조자';


CREATE TABLE `TBL_VACATION`
(
    `VACATION_CODE`    BIGINT NOT NULL AUTO_INCREMENT
 COMMENT '휴가신청서고유코드',
    `VACATION_TYPE`    VARCHAR(100) NOT NULL COMMENT '휴가 구분',
    `VACATION_START_DATE`    DATE NOT NULL COMMENT '휴가 시작',
    `VACATION_END_DATE`    DATE NOT NULL COMMENT '휴가 종료',
    `VACATION_BODY`    VARCHAR(4000) COMMENT '세부사항(사유)',
    `APPROVAL_CODE`    BIGINT COMMENT '문서고유코드',
    `VACATION_EMERGENCY_PHONE`    VARCHAR(100) NOT NULL COMMENT '비상연락망',
 PRIMARY KEY ( `VACATION_CODE` )
) COMMENT = '휴가신청서';



